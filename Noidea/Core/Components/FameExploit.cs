using System;
using PortableRealm.Models;
using PortableRealm.Net.Packets.Incoming;
using PortableRealm.Net.Packets.Outgoing;

namespace Noidea.Core.Components
{
	// Token: 0x0200001E RID: 30
	public class FameExploit : Component
	{
		// Token: 0x060000AF RID: 175 RVA: 0x00002636 File Offset: 0x00000836
		public override void Initialize()
		{
			this.CoreLoop = base.Client.GetComponent<CoreLoop>();
			this.World = base.Client.GetComponent<World>();
			base.Hook<NewTick>(new Action<NewTick>(this.OnNewTick));
		}

		// Token: 0x060000B0 RID: 176 RVA: 0x0000538C File Offset: 0x0000358C
		private void OnNewTick(NewTick obj)
		{
			bool flag = obj.TickId == 10 && this.World.Name == "Exalted Tutorial";
			if (flag)
			{
				base.Client.Log("Sending fame");
				UseItem packet = new UseItem
				{
					ItemUsePos = base.Client.Position,
					SlotObject = new SlotObjectData
					{
						ObjectId = base.Client.ObjectId,
						ObjectType = base.Client.Inventory[1],
						SlotId = 1
					},
					Time = this.CoreLoop.Time,
					UseType = 0
				};
				for (int i = 0; i < 25000; i++)
				{
					base.Client.Send(packet);
				}
				base.Client.Send(new Escape());
			}
		}

		// Token: 0x04000076 RID: 118
		public CoreLoop CoreLoop;

		// Token: 0x04000077 RID: 119
		public World World;
	}
}
